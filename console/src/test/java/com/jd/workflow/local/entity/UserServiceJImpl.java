package com.jd.workflow.local.entity;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONObject;
import com.alibaba.fastjson.TypeReference;
import com.alibaba.fastjson.parser.DefaultJSONParser;
import com.alibaba.fastjson.parser.Feature;
import com.alibaba.fastjson.parser.ParserConfig;
import com.alibaba.fastjson.serializer.SerializeConfig;
import com.alibaba.fastjson.serializer.SerializerFeature;
import com.google.gson.Gson;
import com.jd.jsf.gd.codec.json.FastjsonDecoder;
import com.jd.jsf.gd.codec.json.FastjsonEncoder;
import com.jd.jsf.gd.config.ConsumerConfig;
import com.jd.workflow.jsf.analyzer.AetherJarDownloader;
import com.jd.workflow.jsf.analyzer.MavenJarLocation;
import com.jd.workflow.soap.common.exception.BizException;
import com.jd.workflow.soap.common.util.JsonUtils;
import org.apache.commons.io.FileUtils;
import org.eclipse.aether.collection.DependencyCollectionException;
import org.eclipse.aether.resolution.DependencyResolutionException;

import java.io.File;
import java.io.IOException;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLClassLoader;
import java.util.*;

public class UserServiceJImpl implements IUserService{

    public CommonResult<Long> addUser(UserDto user) {
        return CommonResult.buildSuccessResult(user.getId());
    }


    public CommonResult<UserDto> getUser(Long id) {
        UserDto dto = new UserDto();
        dto.setId(1L);
        dto.setUserCode("wjf");
        dto.setUserName("测试");
        dto.setPassword("abc111");
        return CommonResult.buildSuccessResult(dto);
    }


    public CommonResult<Long> removeUser(Long id) {
        return CommonResult.buildSuccessResult(id);
    }

    @Override
    public Person save(Person person) {
        return person;
    }
    static{


    }
    private static void  downloadJar() throws DependencyCollectionException, DependencyResolutionException, IOException {
        MavenJarLocation location = new MavenJarLocation();
        location.setGroupId("com.jd.trade2.sdk");
        location.setArtifactId("trade-export");
        location.setVersion("3.0.0-zxz7-SNAPSHOT");
        File root = new File("d:/tmp/trade/jar");
        List<File> files = AetherJarDownloader.downloadAllJar(location, root);
        for (File file : files) {
            FileUtils.copyFile(file,new File(root,file.getName()));
        }

        /**
         URL[] urls = new URL[files.size()];
         for (int i = 0; i < files.size(); i++) {
         try {
         urls[i] = files.get(i).toURI().toURL();
         } catch (MalformedURLException e) {
         throw new BizException("加载类失败："+e.getMessage(),e);
         }
         }
         */
    }
    public static void jsonParser(){
        String json = "[{\"@type\":\"com.jd.trade2.base.export.identity.IdentityInfoParam\",\"businessTags\":{\"orderTagNamespace\":Set[\"jd.cn.jdr.jszt:order:main\"],\"orderTags\":Set[\"jd.cn.jdr.jszt:order:main\"]},\"systemInfo\":{\"userAgentId\":2,\"buId\":\"301\",\"businessUnitId\":304,\"callerAppName\":\"trade\",\"callerDataCenter\":\"lf\",\"callerIP\":\"1.1.1.1\",\"sdkVersion\":\"1.0\",\"languageCode\":\"zh_CN\"}},{\"@type\":\"com.jd.trade2.export.param.currentorder.CurrentOrderParam\",\"domainCollectionParams\":[{\"@type\":\"com.jd.trade2.assets.coupon.export.param.CouponCollectionParam\",\"childEmpty\":true,\"childList\":[],\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"tags\":{\"@type\":\"java.util.HashMap\",\"useBestCoupon\":{\"@type\":\"com.jd.trade2.base.export.model.extendinfo.value.BooleanValue\",\"v\":true},\"usePlusCoupon\":{\"@type\":\"BooleanValue\",\"v\":true}}},\"version\":\"1.0.0\"},\"modelList\":[],\"type\":{\"namespace\":\"trade.assets.coupon.model.couponCollection\",\"typeClass\":\"com.jd.trade2.assets.coupon.export.param.CouponCollectionParam\",\"value\":\"\",\"version\":\"1.0\"},\"useBestCoupon\":true,\"usePlusCoupon\":true},{\"@type\":\"com.jd.trade2.terminal.export.param.TerminalCollectionParam\",\"childList\":[{\"@type\":\"com.jd.trade2.terminal.export.param.general.GeneralTerminalItemParam\",\"appLbsInfo\":null,\"appVersion\":\"2.2\",\"client\":null,\"clientBrowserName\":\"chrome\",\"clientInfo\":null,\"clientSystemName\":\"ios\",\"clientVersion\":null,\"eid\":null,\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"pc\":{\"@type\":\"java.util.HashMap\",\"clientBrowserName\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"pcVipIdc\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"jdb\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"userAgent\":{\"@type\":\"StringValue\",\"v\":\"111\"}},\"phone\":{\"@type\":\"java.util.HashMap\",\"appVersion\":{\"@type\":\"StringValue\",\"v\":\"2.2\"},\"clientInfo\":{\"@type\":\"StringValue\",\"v\":\"127.0.0.1\"},\"appLbsInfo\":{\"@type\":\"StringValue\",\"v\":\"chrome\"}},\"callerServer\":{\"@type\":\"java.util.HashMap\",\"port\":{\"@type\":\"StringValue\",\"v\":\"80\"},\"serverName\":{\"@type\":\"StringValue\",\"v\":\"10.180.1.19\"}},\"client\":{\"@type\":\"java.util.HashMap\",\"eid\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"jda\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"userIp\":{\"@type\":\"StringValue\",\"v\":\"10.180.1.19\"},\"clientSystemName\":{\"@type\":\"StringValue\",\"v\":\"ios\"},\"jdv\":{\"@type\":\"StringValue\",\"v\":null}}},\"version\":\"1.0.0\"},\"jda\":null,\"jdb\":null,\"jdv\":null,\"modelList\":[],\"openId\":null,\"pcServerName\":null,\"pcVipIdc\":null,\"port\":\"80\",\"serverName\":\"10.180.1.19\",\"type\":{\"namespace\":\"trade.terminal.model.terminal\",\"typeClass\":\"com.jd.trade2.terminal.export.param.general.GeneralTerminalItemParam\",\"value\":\"\",\"version\":\"1.0\"},\"userAgent\":\"111\",\"userIP\":\"10.180.1.19\",\"uuid\":null}],\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\"},\"version\":\"1.0.0\"},\"modelList\":[],\"type\":{\"namespace\":\"trade.terminal.model.terminalCollection\",\"typeClass\":\"com.jd.trade2.terminal.export.param.TerminalCollectionParam\",\"value\":\"\",\"version\":\"1.0\"}},{\"@type\":\"com.jd.trade2.assets.redpacket.export.param.RedPacketCollectionParam\",\"childList\":[],\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"total\":{\"@type\":\"java.util.HashMap\",\"useChannelFlag\":{\"@type\":\"StringValue\",\"v\":\"10100000\"},\"useSupermarketCardFunction\":{\"@type\":\"BooleanValue\",\"v\":true},\"orgName\":{\"@type\":\"StringValue\",\"v\":\"JD\"}}}},\"modelList\":[],\"operateSupermarketCardMark\":false,\"partList\":[],\"orgName\":\"JD\",\"supportUseFlag\":true,\"type\":{\"namespace\":\"trade.assets.redPacket.model.redPacketCollection\",\"typeClass\":\"com.jd.trade2.assets.redpacket.export.param.RedPacketCollectionParam\",\"typeSet\":Set[\"trade.assets.redPacket.model.redPacketCollection\"],\"value\":\"\",\"version\":\"1.0.0\"},\"useSupermarketCardFunction\":true,\"version\":\"1.0.0\"},{\"@type\":\"com.jd.trade2.assets.giftcard.export.param.GiftCardCollectionParam\",\"childList\":[],\"firstTimeGetCurrent\":0,\"haveWMCard\":false,\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"total\":{\"@type\":\"java.util.HashMap\",\"useSupermarketCardFunction\":{\"@type\":\"BooleanValue\",\"v\":true}}}},\"modelList\":[],\"page\":1,\"pageSize\":100,\"partList\":[],\"queryType\":0,\"type\":{\"namespace\":\"trade.assets.giftCard.model.giftCardCollection\",\"typeClass\":\"com.jd.trade2.assets.giftcard.export.param.GiftCardCollectionParam\",\"typeSet\":Set[\"trade.assets.giftCard.model.giftCardCollection\"],\"value\":\"\",\"version\":\"1.0.0\"},\"useSupermarketCardFunction\":true,\"version\":\"1.0.0\"},{\"@type\":\"com.jd.trade2.shoppinglist.export.param.ShoppingListCollectionParam\",\"cartType\":0,\"childEmpty\":true,\"childList\":[],\"ignoreItemPriceIncrease\":false,\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"cartParam\":{\"@type\":\"java.util.HashMap\",\"otcMergeIntoMainFlow\":{\"@type\":\"BooleanValue\",\"v\":true},\"requestConditionTypes\":{\"@type\":\"IntegerListValue\",\"v\":[103,105,106,301,305]},\"intoMainFlowTags\":{\"@type\":\"StringSetValue\",\"v\":Set[\"useGiftService\",\"useJdHomeService\",\"useFurnitureService\",\"vsuitToMan\",\"checkPartitionProduct\",\"otcMerge\",\"hyj\",\"jps\",\"djrh\",\"overseaMerge\",\"c2m\",\"preSaleOrder\",\"preSaleStock\",\"lbs\",\"postToShop\",\"aloneMerge\",\"yydsMerge\",\"useLsService\",\"cfyhg\",\"cwcfyhg\",\"popKnowledgeMerge\",\"overseaPreSaleOrder\",\"yushouToPromo\",\"timeOrder\",\"bargainToCart\",\"soldOverseaPreSaleOrder\",\"treatmentSuit\",\"cwbg\",\"giftc2m\",\"superMarketCard\",\"weighGoods\",\"msbybt\",\"use3cService\",\"scf\",\"dzs\",\"addPromotionLadders\",\"jgfwsp\",\"newVirtualGroup\",\"secKillPrice\"]}}},\"version\":\"1.0.0\"},\"invalidStoreIdSet\":Set[],\"modelList\":[],\"otcMergeIntoMainFlow\":true,\"requestConditionTypes\":[103,105,106,301,305],\"type\":{\"namespace\":\"trade.shoppinglist.model.shoppingListCollection\",\"typeClass\":\"com.jd.trade2.shoppinglist.export.param.ShoppingListCollectionParam\",\"value\":\"\",\"version\":\"1.0\"},\"validStoreIdSet\":Set[]}],\"signParam\":{\"pin\":\"jiesuantest21\"}}]";
        //String json = "[{\"@type\":\"com.jd.trade2.base.export.identity.IdentityInfoParam\",\"businessTags\":{\"orderTagNamespace\":Set[\"jd.cn.jdr.jszt:order:main\"],\"orderTags\":Set[\"jd.cn.jdr.jszt:order:main\"]},\"systemInfo\":{\"userAgentId\":2,\"buId\":\"301\",\"businessUnitId\":304,\"callerAppName\":\"trade\",\"callerDataCenter\":\"lf\",\"callerIP\":\"1.1.1.1\",\"sdkVersion\":\"1.0\",\"languageCode\":\"zh_CN\"}},{\"@type\":\"com.jd.trade2.export.param.currentorder.CurrentOrderParam\",\"domainCollectionParams\":[{\"@type\":\"com.jd.trade2.assets.coupon.export.param.CouponCollectionParam\",\"childEmpty\":true,\"childList\":[],\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"tags\":{\"@type\":\"java.util.HashMap\",\"useBestCoupon\":{\"@type\":\"BooleanValue\",\"v\":true},\"usePlusCoupon\":{\"@type\":\"BooleanValue\",\"v\":true}}},\"version\":\"1.0.0\"},\"modelList\":[],\"type\":{\"namespace\":\"trade.assets.coupon.model.couponCollection\",\"typeClass\":\"com.jd.trade2.assets.coupon.export.param.CouponCollectionParam\",\"value\":\"\",\"version\":\"1.0\"},\"useBestCoupon\":true,\"usePlusCoupon\":true},{\"@type\":\"com.jd.trade2.terminal.export.param.TerminalCollectionParam\",\"childList\":[{\"@type\":\"com.jd.trade2.terminal.export.param.general.GeneralTerminalItemParam\",\"appLbsInfo\":null,\"appVersion\":\"2.2\",\"client\":null,\"clientBrowserName\":\"chrome\",\"clientInfo\":null,\"clientSystemName\":\"ios\",\"clientVersion\":null,\"eid\":null,\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"pc\":{\"@type\":\"java.util.HashMap\",\"clientBrowserName\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"pcVipIdc\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"jdb\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"userAgent\":{\"@type\":\"StringValue\",\"v\":\"111\"}},\"phone\":{\"@type\":\"java.util.HashMap\",\"appVersion\":{\"@type\":\"StringValue\",\"v\":\"2.2\"},\"clientInfo\":{\"@type\":\"StringValue\",\"v\":\"127.0.0.1\"},\"appLbsInfo\":{\"@type\":\"StringValue\",\"v\":\"chrome\"}},\"callerServer\":{\"@type\":\"java.util.HashMap\",\"port\":{\"@type\":\"StringValue\",\"v\":\"80\"},\"serverName\":{\"@type\":\"StringValue\",\"v\":\"10.180.1.19\"}},\"client\":{\"@type\":\"java.util.HashMap\",\"eid\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"jda\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"userIp\":{\"@type\":\"StringValue\",\"v\":\"10.180.1.19\"},\"clientSystemName\":{\"@type\":\"StringValue\",\"v\":\"ios\"},\"jdv\":{\"@type\":\"StringValue\",\"v\":null}}},\"version\":\"1.0.0\"},\"jda\":null,\"jdb\":null,\"jdv\":null,\"modelList\":[],\"openId\":null,\"pcServerName\":null,\"pcVipIdc\":null,\"port\":\"80\",\"serverName\":\"10.180.1.19\",\"type\":{\"namespace\":\"trade.terminal.model.terminal\",\"typeClass\":\"com.jd.trade2.terminal.export.param.general.GeneralTerminalItemParam\",\"value\":\"\",\"version\":\"1.0\"},\"userAgent\":\"111\",\"userIP\":\"10.180.1.19\",\"uuid\":null}],\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\"},\"version\":\"1.0.0\"},\"modelList\":[],\"type\":{\"namespace\":\"trade.terminal.model.terminalCollection\",\"typeClass\":\"com.jd.trade2.terminal.export.param.TerminalCollectionParam\",\"value\":\"\",\"version\":\"1.0\"}},{\"@type\":\"com.jd.trade2.assets.redpacket.export.param.RedPacketCollectionParam\",\"childList\":[],\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"total\":{\"@type\":\"java.util.HashMap\",\"useChannelFlag\":{\"@type\":\"StringValue\",\"v\":\"10100000\"},\"useSupermarketCardFunction\":{\"@type\":\"BooleanValue\",\"v\":true},\"orgName\":{\"@type\":\"StringValue\",\"v\":\"JD\"}}}},\"modelList\":[],\"operateSupermarketCardMark\":false,\"partList\":[],\"orgName\":\"JD\",\"supportUseFlag\":true,\"type\":{\"namespace\":\"trade.assets.redPacket.model.redPacketCollection\",\"typeClass\":\"com.jd.trade2.assets.redpacket.export.param.RedPacketCollectionParam\",\"typeSet\":Set[\"trade.assets.redPacket.model.redPacketCollection\"],\"value\":\"\",\"version\":\"1.0.0\"},\"useSupermarketCardFunction\":true,\"version\":\"1.0.0\"},{\"@type\":\"com.jd.trade2.assets.giftcard.export.param.GiftCardCollectionParam\",\"childList\":[],\"firstTimeGetCurrent\":0,\"haveWMCard\":false,\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"total\":{\"@type\":\"java.util.HashMap\",\"useSupermarketCardFunction\":{\"@type\":\"BooleanValue\",\"v\":true}}}},\"modelList\":[],\"page\":1,\"pageSize\":100,\"partList\":[],\"queryType\":0,\"type\":{\"namespace\":\"trade.assets.giftCard.model.giftCardCollection\",\"typeClass\":\"com.jd.trade2.assets.giftcard.export.param.GiftCardCollectionParam\",\"typeSet\":Set[\"trade.assets.giftCard.model.giftCardCollection\"],\"value\":\"\",\"version\":\"1.0.0\"},\"useSupermarketCardFunction\":true,\"version\":\"1.0.0\"},{\"@type\":\"com.jd.trade2.shoppinglist.export.param.ShoppingListCollectionParam\",\"cartType\":0,\"childEmpty\":true,\"childList\":[],\"ignoreItemPriceIncrease\":false,\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"cartParam\":{\"@type\":\"java.util.HashMap\",\"otcMergeIntoMainFlow\":{\"@type\":\"BooleanValue\",\"v\":true},\"requestConditionTypes\":{\"@type\":\"IntegerListValue\",\"v\":[103,105,106,301,305]},\"intoMainFlowTags\":{\"@type\":\"StringSetValue\",\"v\":Set[\"useGiftService\",\"useJdHomeService\",\"useFurnitureService\",\"vsuitToMan\",\"checkPartitionProduct\",\"otcMerge\",\"hyj\",\"jps\",\"djrh\",\"overseaMerge\",\"c2m\",\"preSaleOrder\",\"preSaleStock\",\"lbs\",\"postToShop\",\"aloneMerge\",\"yydsMerge\",\"useLsService\",\"cfyhg\",\"cwcfyhg\",\"popKnowledgeMerge\",\"overseaPreSaleOrder\",\"yushouToPromo\",\"timeOrder\",\"bargainToCart\",\"soldOverseaPreSaleOrder\",\"treatmentSuit\",\"cwbg\",\"giftc2m\",\"superMarketCard\",\"weighGoods\",\"msbybt\",\"use3cService\",\"scf\",\"dzs\",\"addPromotionLadders\",\"jgfwsp\",\"newVirtualGroup\",\"secKillPrice\"]}}},\"version\":\"1.0.0\"},\"invalidStoreIdSet\":Set[],\"modelList\":[],\"otcMergeIntoMainFlow\":true,\"requestConditionTypes\":[103,105,106,301,305],\"type\":{\"namespace\":\"trade.shoppinglist.model.shoppingListCollection\",\"typeClass\":\"com.jd.trade2.shoppinglist.export.param.ShoppingListCollectionParam\",\"value\":\"\",\"version\":\"1.0\"},\"validStoreIdSet\":Set[]}],\"signParam\":{\"pin\":\"jiesuantest21\"}}]";
        //String json = "[{\"@type\":\"com.jd.trade2.base.export.identity.IdentityInfoParam\",\"businessTags\":{\"orderTagNamespace\":Set[\"jd.cn.jdr.jszt:order:main\"],\"orderTags\":Set[\"jd.cn.jdr.jszt:order:main\"]},\"systemInfo\":{\"userAgentId\":2,\"buId\":\"301\",\"businessUnitId\":304,\"callerAppName\":\"trade\",\"callerDataCenter\":\"lf\",\"callerIP\":\"1.1.1.1\",\"sdkVersion\":\"1.0\",\"languageCode\":\"zh_CN\"}},{\"@type\":\"com.jd.trade2.export.param.currentorder.CurrentOrderParam\",\"domainCollectionParams\":[{\"@type\":\"com.jd.trade2.assets.coupon.export.param.CouponCollectionParam\",\"childEmpty\":true,\"childList\":[],\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"tags\":{\"@type\":\"java.util.HashMap\",\"useBestCoupon\":{\"@type\":\"BooleanValue\",\"v\":true},\"usePlusCoupon\":{\"@type\":\"BooleanValue\",\"v\":true}}},\"version\":\"1.0.0\"},\"modelList\":[],\"type\":{\"namespace\":\"trade.assets.coupon.model.couponCollection\",\"typeClass\":\"com.jd.trade2.assets.coupon.export.param.CouponCollectionParam\",\"value\":\"\",\"version\":\"1.0\"},\"useBestCoupon\":true,\"usePlusCoupon\":true},{\"@type\":\"com.jd.trade2.terminal.export.param.TerminalCollectionParam\",\"childList\":[{\"@type\":\"com.jd.trade2.terminal.export.param.general.GeneralTerminalItemParam\",\"appLbsInfo\":null,\"appVersion\":\"2.2\",\"client\":null,\"clientBrowserName\":\"chrome\",\"clientInfo\":null,\"clientSystemName\":\"ios\",\"clientVersion\":null,\"eid\":null,\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"pc\":{\"@type\":\"java.util.HashMap\",\"clientBrowserName\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"pcVipIdc\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"jdb\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"userAgent\":{\"@type\":\"StringValue\",\"v\":\"111\"}},\"phone\":{\"@type\":\"java.util.HashMap\",\"appVersion\":{\"@type\":\"StringValue\",\"v\":\"2.2\"},\"clientInfo\":{\"@type\":\"StringValue\",\"v\":\"127.0.0.1\"},\"appLbsInfo\":{\"@type\":\"StringValue\",\"v\":\"chrome\"}},\"callerServer\":{\"@type\":\"java.util.HashMap\",\"port\":{\"@type\":\"StringValue\",\"v\":\"80\"},\"serverName\":{\"@type\":\"StringValue\",\"v\":\"10.180.1.19\"}},\"client\":{\"@type\":\"java.util.HashMap\",\"eid\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"jda\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"userIp\":{\"@type\":\"StringValue\",\"v\":\"10.180.1.19\"},\"clientSystemName\":{\"@type\":\"StringValue\",\"v\":\"ios\"},\"jdv\":{\"@type\":\"StringValue\",\"v\":null}}},\"version\":\"1.0.0\"},\"jda\":null,\"jdb\":null,\"jdv\":null,\"modelList\":[],\"openId\":null,\"pcServerName\":null,\"pcVipIdc\":null,\"port\":\"80\",\"serverName\":\"10.180.1.19\",\"type\":{\"namespace\":\"trade.terminal.model.terminal\",\"typeClass\":\"com.jd.trade2.terminal.export.param.general.GeneralTerminalItemParam\",\"value\":\"\",\"version\":\"1.0\"},\"userAgent\":\"111\",\"userIP\":\"10.180.1.19\",\"uuid\":null}],\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\"},\"version\":\"1.0.0\"},\"modelList\":[],\"type\":{\"namespace\":\"trade.terminal.model.terminalCollection\",\"typeClass\":\"com.jd.trade2.terminal.export.param.TerminalCollectionParam\",\"value\":\"\",\"version\":\"1.0\"}},{\"@type\":\"com.jd.trade2.assets.redpacket.export.param.RedPacketCollectionParam\",\"childList\":[],\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"total\":{\"@type\":\"java.util.HashMap\",\"useChannelFlag\":{\"@type\":\"StringValue\",\"v\":\"10100000\"},\"useSupermarketCardFunction\":{\"@type\":\"BooleanValue\",\"v\":true},\"orgName\":{\"@type\":\"StringValue\",\"v\":\"JD\"}}}},\"modelList\":[],\"operateSupermarketCardMark\":false,\"partList\":[],\"orgName\":\"JD\",\"supportUseFlag\":true,\"type\":{\"namespace\":\"trade.assets.redPacket.model.redPacketCollection\",\"typeClass\":\"com.jd.trade2.assets.redpacket.export.param.RedPacketCollectionParam\",\"typeSet\":Set[\"trade.assets.redPacket.model.redPacketCollection\"],\"value\":\"\",\"version\":\"1.0.0\"},\"useSupermarketCardFunction\":true,\"version\":\"1.0.0\"},{\"@type\":\"com.jd.trade2.assets.giftcard.export.param.GiftCardCollectionParam\",\"childList\":[],\"firstTimeGetCurrent\":0,\"haveWMCard\":false,\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"total\":{\"@type\":\"java.util.HashMap\",\"useSupermarketCardFunction\":{\"@type\":\"BooleanValue\",\"v\":true}}}},\"modelList\":[],\"page\":1,\"pageSize\":100,\"partList\":[],\"queryType\":0,\"type\":{\"namespace\":\"trade.assets.giftCard.model.giftCardCollection\",\"typeClass\":\"com.jd.trade2.assets.giftcard.export.param.GiftCardCollectionParam\",\"typeSet\":Set[\"trade.assets.giftCard.model.giftCardCollection\"],\"value\":\"\",\"version\":\"1.0.0\"},\"useSupermarketCardFunction\":true,\"version\":\"1.0.0\"},{\"@type\":\"com.jd.trade2.shoppinglist.export.param.ShoppingListCollectionParam\",\"cartType\":0,\"childEmpty\":true,\"childList\":[],\"ignoreItemPriceIncrease\":false,\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"cartParam\":{\"@type\":\"java.util.HashMap\",\"otcMergeIntoMainFlow\":{\"@type\":\"BooleanValue\",\"v\":true},\"requestConditionTypes\":{\"@type\":\"IntegerListValue\",\"v\":[103,105,106,301,305]},\"intoMainFlowTags\":{\"@type\":\"StringSetValue\",\"v\":Set[\"useGiftService\",\"useJdHomeService\",\"useFurnitureService\",\"vsuitToMan\",\"checkPartitionProduct\",\"otcMerge\",\"hyj\",\"jps\",\"djrh\",\"overseaMerge\",\"c2m\",\"preSaleOrder\",\"preSaleStock\",\"lbs\",\"postToShop\",\"aloneMerge\",\"yydsMerge\",\"useLsService\",\"cfyhg\",\"cwcfyhg\",\"popKnowledgeMerge\",\"overseaPreSaleOrder\",\"yushouToPromo\",\"timeOrder\",\"bargainToCart\",\"soldOverseaPreSaleOrder\",\"treatmentSuit\",\"cwbg\",\"giftc2m\",\"superMarketCard\",\"weighGoods\",\"msbybt\",\"use3cService\",\"scf\",\"dzs\",\"addPromotionLadders\",\"jgfwsp\",\"newVirtualGroup\",\"secKillPrice\"]}}},\"version\":\"1.0.0\"},\"invalidStoreIdSet\":Set[],\"modelList\":[],\"otcMergeIntoMainFlow\":true,\"requestConditionTypes\":[103,105,106,301,305],\"type\":{\"namespace\":\"trade.shoppinglist.model.shoppingListCollection\",\"typeClass\":\"com.jd.trade2.shoppinglist.export.param.ShoppingListCollectionParam\",\"value\":\"\",\"version\":\"1.0\"},\"validStoreIdSet\":Set[]}],\"signParam\":{\"pin\":\"jiesuantest21\"}}]";
        //String json = "{\"name\":Set[\"aaa\"]}";
        //System.out.println(JsonUtils.parse(json));
        ParserConfig parserConfig = new ParserConfig();
        parserConfig.setAutoTypeSupport(true);
        ParserConfig.getGlobalInstance().setAutoTypeSupport(true);
        ParserConfig.getGlobalInstance().setDefaultClassLoader(Thread.currentThread().getContextClassLoader());
        // gson反序列化
        Object obj = JSON.parseArray(json);



        System.out.println(obj);
    }
    private static void writeJson() {
        Map<String, Object> map = new HashMap<>();
        map.put("name", "wjf");
        map.put("set", new HashSet<>());

        String result = com.alibaba.fastjson.JSON.toJSONString(map, SerializerFeature.WriteClassName);
        System.out.println(result);
    }
    private static Object jsfCaller(){
        ConsumerConfig config = new ConsumerConfig();
        config.setAlias("eone-59258-0");
        config.setInterfaceId("com.jd.trade2.export.service.GetCurrentOrderExportService");
        config.setProtocol("jsf");
        config.setSerialization("hessian");
        String json = "[{\"@type\":\"com.jd.trade2.base.export.identity.IdentityInfoParam\",\"businessTags\":{\"orderTagNamespace\":Set[\"jd.cn.jdr.jszt:order:main\"],\"orderTags\":Set[\"jd.cn.jdr.jszt:order:main\"]},\"systemInfo\":{\"userAgentId\":2,\"buId\":\"301\",\"businessUnitId\":304,\"callerAppName\":\"trade\",\"callerDataCenter\":\"lf\",\"callerIP\":\"1.1.1.1\",\"sdkVersion\":\"1.0\",\"languageCode\":\"zh_CN\"}},{\"@type\":\"com.jd.trade2.export.param.currentorder.CurrentOrderParam\",\"domainCollectionParams\":[{\"@type\":\"com.jd.trade2.assets.coupon.export.param.CouponCollectionParam\",\"childEmpty\":true,\"childList\":[],\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"tags\":{\"@type\":\"java.util.HashMap\",\"useBestCoupon\":{\"@type\":\"com.jd.trade2.base.export.model.extendinfo.value.BooleanValue\",\"v\":true},\"usePlusCoupon\":{\"@type\":\"BooleanValue\",\"v\":true}}},\"version\":\"1.0.0\"},\"modelList\":[],\"type\":{\"namespace\":\"trade.assets.coupon.model.couponCollection\",\"typeClass\":\"com.jd.trade2.assets.coupon.export.param.CouponCollectionParam\",\"value\":\"\",\"version\":\"1.0\"},\"useBestCoupon\":true,\"usePlusCoupon\":true},{\"@type\":\"com.jd.trade2.terminal.export.param.TerminalCollectionParam\",\"childList\":[{\"@type\":\"com.jd.trade2.terminal.export.param.general.GeneralTerminalItemParam\",\"appLbsInfo\":null,\"appVersion\":\"2.2\",\"client\":null,\"clientBrowserName\":\"chrome\",\"clientInfo\":null,\"clientSystemName\":\"ios\",\"clientVersion\":null,\"eid\":null,\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"pc\":{\"@type\":\"java.util.HashMap\",\"clientBrowserName\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"pcVipIdc\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"jdb\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"userAgent\":{\"@type\":\"StringValue\",\"v\":\"111\"}},\"phone\":{\"@type\":\"java.util.HashMap\",\"appVersion\":{\"@type\":\"StringValue\",\"v\":\"2.2\"},\"clientInfo\":{\"@type\":\"StringValue\",\"v\":\"127.0.0.1\"},\"appLbsInfo\":{\"@type\":\"StringValue\",\"v\":\"chrome\"}},\"callerServer\":{\"@type\":\"java.util.HashMap\",\"port\":{\"@type\":\"StringValue\",\"v\":\"80\"},\"serverName\":{\"@type\":\"StringValue\",\"v\":\"10.180.1.19\"}},\"client\":{\"@type\":\"java.util.HashMap\",\"eid\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"jda\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"userIp\":{\"@type\":\"StringValue\",\"v\":\"10.180.1.19\"},\"clientSystemName\":{\"@type\":\"StringValue\",\"v\":\"ios\"},\"jdv\":{\"@type\":\"StringValue\",\"v\":null}}},\"version\":\"1.0.0\"},\"jda\":null,\"jdb\":null,\"jdv\":null,\"modelList\":[],\"openId\":null,\"pcServerName\":null,\"pcVipIdc\":null,\"port\":\"80\",\"serverName\":\"10.180.1.19\",\"type\":{\"namespace\":\"trade.terminal.model.terminal\",\"typeClass\":\"com.jd.trade2.terminal.export.param.general.GeneralTerminalItemParam\",\"value\":\"\",\"version\":\"1.0\"},\"userAgent\":\"111\",\"userIP\":\"10.180.1.19\",\"uuid\":null}],\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\"},\"version\":\"1.0.0\"},\"modelList\":[],\"type\":{\"namespace\":\"trade.terminal.model.terminalCollection\",\"typeClass\":\"com.jd.trade2.terminal.export.param.TerminalCollectionParam\",\"value\":\"\",\"version\":\"1.0\"}},{\"@type\":\"com.jd.trade2.assets.redpacket.export.param.RedPacketCollectionParam\",\"childList\":[],\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"total\":{\"@type\":\"java.util.HashMap\",\"useChannelFlag\":{\"@type\":\"StringValue\",\"v\":\"10100000\"},\"useSupermarketCardFunction\":{\"@type\":\"BooleanValue\",\"v\":true},\"orgName\":{\"@type\":\"StringValue\",\"v\":\"JD\"}}}},\"modelList\":[],\"operateSupermarketCardMark\":false,\"partList\":[],\"orgName\":\"JD\",\"supportUseFlag\":true,\"type\":{\"namespace\":\"trade.assets.redPacket.model.redPacketCollection\",\"typeClass\":\"com.jd.trade2.assets.redpacket.export.param.RedPacketCollectionParam\",\"typeSet\":Set[\"trade.assets.redPacket.model.redPacketCollection\"],\"value\":\"\",\"version\":\"1.0.0\"},\"useSupermarketCardFunction\":true,\"version\":\"1.0.0\"},{\"@type\":\"com.jd.trade2.assets.giftcard.export.param.GiftCardCollectionParam\",\"childList\":[],\"firstTimeGetCurrent\":0,\"haveWMCard\":false,\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"total\":{\"@type\":\"java.util.HashMap\",\"useSupermarketCardFunction\":{\"@type\":\"BooleanValue\",\"v\":true}}}},\"modelList\":[],\"page\":1,\"pageSize\":100,\"partList\":[],\"queryType\":0,\"type\":{\"namespace\":\"trade.assets.giftCard.model.giftCardCollection\",\"typeClass\":\"com.jd.trade2.assets.giftcard.export.param.GiftCardCollectionParam\",\"typeSet\":Set[\"trade.assets.giftCard.model.giftCardCollection\"],\"value\":\"\",\"version\":\"1.0.0\"},\"useSupermarketCardFunction\":true,\"version\":\"1.0.0\"},{\"@type\":\"com.jd.trade2.shoppinglist.export.param.ShoppingListCollectionParam\",\"cartType\":0,\"childEmpty\":true,\"childList\":[],\"ignoreItemPriceIncrease\":false,\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"cartParam\":{\"@type\":\"java.util.HashMap\",\"otcMergeIntoMainFlow\":{\"@type\":\"BooleanValue\",\"v\":true},\"requestConditionTypes\":{\"@type\":\"IntegerListValue\",\"v\":[103,105,106,301,305]},\"intoMainFlowTags\":{\"@type\":\"StringSetValue\",\"v\":Set[\"useGiftService\",\"useJdHomeService\",\"useFurnitureService\",\"vsuitToMan\",\"checkPartitionProduct\",\"otcMerge\",\"hyj\",\"jps\",\"djrh\",\"overseaMerge\",\"c2m\",\"preSaleOrder\",\"preSaleStock\",\"lbs\",\"postToShop\",\"aloneMerge\",\"yydsMerge\",\"useLsService\",\"cfyhg\",\"cwcfyhg\",\"popKnowledgeMerge\",\"overseaPreSaleOrder\",\"yushouToPromo\",\"timeOrder\",\"bargainToCart\",\"soldOverseaPreSaleOrder\",\"treatmentSuit\",\"cwbg\",\"giftc2m\",\"superMarketCard\",\"weighGoods\",\"msbybt\",\"use3cService\",\"scf\",\"dzs\",\"addPromotionLadders\",\"jgfwsp\",\"newVirtualGroup\",\"secKillPrice\"]}}},\"version\":\"1.0.0\"},\"invalidStoreIdSet\":Set[],\"modelList\":[],\"otcMergeIntoMainFlow\":true,\"requestConditionTypes\":[103,105,106,301,305],\"type\":{\"namespace\":\"trade.shoppinglist.model.shoppingListCollection\",\"typeClass\":\"com.jd.trade2.shoppinglist.export.param.ShoppingListCollectionParam\",\"value\":\"\",\"version\":\"1.0\"},\"validStoreIdSet\":Set[]}],\"signParam\":{\"pin\":\"jiesuantest21\"}}]";
        Object obj = config.refer();
        Method method = null;
        for (Method declaredMethod : obj.getClass().getDeclaredMethods()) {
            if("getCurrentOrder".equals(declaredMethod.getName())){
                method = declaredMethod;
                break;
            }
        }
        ParserConfig.getGlobalInstance().setAutoTypeSupport(true);
        List<Object> types = JSON.parseArray(json, method.getParameterTypes());

        try {
            Object result = method.invoke(obj, types.toArray());
            return result;
        } catch (IllegalAccessException e) {
            throw new RuntimeException(e);
        } catch (InvocationTargetException e) {
            throw new RuntimeException(e);
        }
    }
    public static void main(String[] args) throws Exception {
        writeJson();
      /*  long start = System.currentTimeMillis();
        downloadJar();
        System.out.println("下载jar耗时："+(System.currentTimeMillis()-start));*/
        Object o = jsfCaller();
        System.out.println(o);
       /* File root = new File("d:/tmp/trade/jar");
        List<URL> urls = new ArrayList<>();
        for (File file : root.listFiles()) {
            if(file.getName().endsWith(".jar")){
                urls.add(file.toURI().toURL());
            }
        }
        ClassLoader contextClassLoader = Thread.currentThread().getContextClassLoader();
        //
        URLClassLoader urlClassLoader = new URLClassLoader(urls.toArray(new URL[0]) ,contextClassLoader);

        Thread.currentThread().setContextClassLoader(urlClassLoader);
        Long start = System.currentTimeMillis();
        jsonParser();
        Long end = System.currentTimeMillis();
        System.out.println("耗时："+(end-start));*/
        String json = "[{\"@type\":\"com.jd.trade2.base.export.identity.IdentityInfoParam\",\"businessTags\":{\"orderTagNamespace\":Set[\"jd.cn.jdr.jszt:order:main\"],\"orderTags\":Set[\"jd.cn.jdr.jszt:order:main\"]},\"systemInfo\":{\"userAgentId\":2,\"buId\":\"301\",\"businessUnitId\":304,\"callerAppName\":\"trade\",\"callerDataCenter\":\"lf\",\"callerIP\":\"1.1.1.1\",\"sdkVersion\":\"1.0\",\"languageCode\":\"zh_CN\"}},{\"@type\":\"com.jd.trade2.export.param.currentorder.CurrentOrderParam\",\"domainCollectionParams\":[{\"@type\":\"com.jd.trade2.assets.coupon.export.param.CouponCollectionParam\",\"childEmpty\":true,\"childList\":[],\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"tags\":{\"@type\":\"java.util.HashMap\",\"useBestCoupon\":{\"@type\":\"com.jd.trade2.base.export.model.extendinfo.value.BooleanValue\",\"v\":true},\"usePlusCoupon\":{\"@type\":\"BooleanValue\",\"v\":true}}},\"version\":\"1.0.0\"},\"modelList\":[],\"type\":{\"namespace\":\"trade.assets.coupon.model.couponCollection\",\"typeClass\":\"com.jd.trade2.assets.coupon.export.param.CouponCollectionParam\",\"value\":\"\",\"version\":\"1.0\"},\"useBestCoupon\":true,\"usePlusCoupon\":true},{\"@type\":\"com.jd.trade2.terminal.export.param.TerminalCollectionParam\",\"childList\":[{\"@type\":\"com.jd.trade2.terminal.export.param.general.GeneralTerminalItemParam\",\"appLbsInfo\":null,\"appVersion\":\"2.2\",\"client\":null,\"clientBrowserName\":\"chrome\",\"clientInfo\":null,\"clientSystemName\":\"ios\",\"clientVersion\":null,\"eid\":null,\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"pc\":{\"@type\":\"java.util.HashMap\",\"clientBrowserName\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"pcVipIdc\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"jdb\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"userAgent\":{\"@type\":\"StringValue\",\"v\":\"111\"}},\"phone\":{\"@type\":\"java.util.HashMap\",\"appVersion\":{\"@type\":\"StringValue\",\"v\":\"2.2\"},\"clientInfo\":{\"@type\":\"StringValue\",\"v\":\"127.0.0.1\"},\"appLbsInfo\":{\"@type\":\"StringValue\",\"v\":\"chrome\"}},\"callerServer\":{\"@type\":\"java.util.HashMap\",\"port\":{\"@type\":\"StringValue\",\"v\":\"80\"},\"serverName\":{\"@type\":\"StringValue\",\"v\":\"10.180.1.19\"}},\"client\":{\"@type\":\"java.util.HashMap\",\"eid\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"jda\":{\"@type\":\"StringValue\",\"v\":\"chrome\"},\"userIp\":{\"@type\":\"StringValue\",\"v\":\"10.180.1.19\"},\"clientSystemName\":{\"@type\":\"StringValue\",\"v\":\"ios\"},\"jdv\":{\"@type\":\"StringValue\",\"v\":null}}},\"version\":\"1.0.0\"},\"jda\":null,\"jdb\":null,\"jdv\":null,\"modelList\":[],\"openId\":null,\"pcServerName\":null,\"pcVipIdc\":null,\"port\":\"80\",\"serverName\":\"10.180.1.19\",\"type\":{\"namespace\":\"trade.terminal.model.terminal\",\"typeClass\":\"com.jd.trade2.terminal.export.param.general.GeneralTerminalItemParam\",\"value\":\"\",\"version\":\"1.0\"},\"userAgent\":\"111\",\"userIP\":\"10.180.1.19\",\"uuid\":null}],\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\"},\"version\":\"1.0.0\"},\"modelList\":[],\"type\":{\"namespace\":\"trade.terminal.model.terminalCollection\",\"typeClass\":\"com.jd.trade2.terminal.export.param.TerminalCollectionParam\",\"value\":\"\",\"version\":\"1.0\"}},{\"@type\":\"com.jd.trade2.assets.redpacket.export.param.RedPacketCollectionParam\",\"childList\":[],\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"total\":{\"@type\":\"java.util.HashMap\",\"useChannelFlag\":{\"@type\":\"StringValue\",\"v\":\"10100000\"},\"useSupermarketCardFunction\":{\"@type\":\"BooleanValue\",\"v\":true},\"orgName\":{\"@type\":\"StringValue\",\"v\":\"JD\"}}}},\"modelList\":[],\"operateSupermarketCardMark\":false,\"partList\":[],\"orgName\":\"JD\",\"supportUseFlag\":true,\"type\":{\"namespace\":\"trade.assets.redPacket.model.redPacketCollection\",\"typeClass\":\"com.jd.trade2.assets.redpacket.export.param.RedPacketCollectionParam\",\"typeSet\":Set[\"trade.assets.redPacket.model.redPacketCollection\"],\"value\":\"\",\"version\":\"1.0.0\"},\"useSupermarketCardFunction\":true,\"version\":\"1.0.0\"},{\"@type\":\"com.jd.trade2.assets.giftcard.export.param.GiftCardCollectionParam\",\"childList\":[],\"firstTimeGetCurrent\":0,\"haveWMCard\":false,\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"total\":{\"@type\":\"java.util.HashMap\",\"useSupermarketCardFunction\":{\"@type\":\"BooleanValue\",\"v\":true}}}},\"modelList\":[],\"page\":1,\"pageSize\":100,\"partList\":[],\"queryType\":0,\"type\":{\"namespace\":\"trade.assets.giftCard.model.giftCardCollection\",\"typeClass\":\"com.jd.trade2.assets.giftcard.export.param.GiftCardCollectionParam\",\"typeSet\":Set[\"trade.assets.giftCard.model.giftCardCollection\"],\"value\":\"\",\"version\":\"1.0.0\"},\"useSupermarketCardFunction\":true,\"version\":\"1.0.0\"},{\"@type\":\"com.jd.trade2.shoppinglist.export.param.ShoppingListCollectionParam\",\"cartType\":0,\"childEmpty\":true,\"childList\":[],\"ignoreItemPriceIncrease\":false,\"info\":{\"domainMap\":{\"@type\":\"java.util.HashMap\",\"cartParam\":{\"@type\":\"java.util.HashMap\",\"otcMergeIntoMainFlow\":{\"@type\":\"BooleanValue\",\"v\":true},\"requestConditionTypes\":{\"@type\":\"IntegerListValue\",\"v\":[103,105,106,301,305]},\"intoMainFlowTags\":{\"@type\":\"StringSetValue\",\"v\":Set[\"useGiftService\",\"useJdHomeService\",\"useFurnitureService\",\"vsuitToMan\",\"checkPartitionProduct\",\"otcMerge\",\"hyj\",\"jps\",\"djrh\",\"overseaMerge\",\"c2m\",\"preSaleOrder\",\"preSaleStock\",\"lbs\",\"postToShop\",\"aloneMerge\",\"yydsMerge\",\"useLsService\",\"cfyhg\",\"cwcfyhg\",\"popKnowledgeMerge\",\"overseaPreSaleOrder\",\"yushouToPromo\",\"timeOrder\",\"bargainToCart\",\"soldOverseaPreSaleOrder\",\"treatmentSuit\",\"cwbg\",\"giftc2m\",\"superMarketCard\",\"weighGoods\",\"msbybt\",\"use3cService\",\"scf\",\"dzs\",\"addPromotionLadders\",\"jgfwsp\",\"newVirtualGroup\",\"secKillPrice\"]}}},\"version\":\"1.0.0\"},\"invalidStoreIdSet\":Set[],\"modelList\":[],\"otcMergeIntoMainFlow\":true,\"requestConditionTypes\":[103,105,106,301,305],\"type\":{\"namespace\":\"trade.shoppinglist.model.shoppingListCollection\",\"typeClass\":\"com.jd.trade2.shoppinglist.export.param.ShoppingListCollectionParam\",\"value\":\"\",\"version\":\"1.0\"},\"validStoreIdSet\":Set[]}],\"signParam\":{\"pin\":\"jiesuantest21\"}}]";
        String jsonString = JSON.toJSONString(json, true);
        System.out.println(jsonString);
    }
}
